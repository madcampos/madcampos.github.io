<!doctype html><html lang="en-US" itemscope itemtype="https://schema.org/WebPage"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://madcampos.dev/blog/2023/05/hello-world/"><link rel="alternate" type="application/atom+xml" href="https://madcampos.dev/blog/rss.xml" title="Marco Campos' Blog"><title>Hello, World! | Marco Campos | Blog</title><link rel="icon" href="https://madcampos.dev/icons/favicon.svg"><meta name="theme-color" content="#0080ff"><meta name="keywords" itemprop="keywords" content="personal, senior web developer, web developer, vue.js, vue, node.js, javascript, typescript, webdev"><meta property="og:title" name="twitter:title" itemprop="name" content="Hello, World!"><meta property="og:description" name="description" itemprop="abstract" content="<p>Summary of the experience and hurdles of coding this blog.</p>
"><meta property="og:image" name="twitter:image" itemprop="image" content="https://madcampos.dev/images/me.jpg"><meta property="og:type" content="website"><meta property="og:locale" itemprop="inLanguage" content="en_US"><meta property="og:url" itemprop="url" content="https://madcampos.dev/blog/2023/05/hello-world/"><meta name="twitter:card" content="summary"><meta name="twitter:dnt" content="on"><meta name="pinterest" content="nopin" description="Pintrest not allowed here!"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="apple-touch-icon" href="https://madcampos.dev/icons/maskable/apple-icon-180.png"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-2048-2732.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-2732-2048.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-1668-2388.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-2388-1668.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-1536-2048.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-2048-1536.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-1668-2224.png" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-2224-1668.png" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-1620-2160.png" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-2160-1620.png" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-1284-2778.png" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-2778-1284.png" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-1170-2532.png" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-2532-1170.png" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-1125-2436.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-2436-1125.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-1242-2688.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-2688-1242.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-828-1792.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-1792-828.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-1242-2208.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-2208-1242.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-750-1334.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-1334-750.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-640-1136.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://madcampos.dev/splash/apple-splash-1136-640.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="stylesheet" href="https://madcampos.dev/assets/base-8087d47f.css"><link rel="stylesheet" href="https://madcampos.dev/assets/blog-ab0c7b64.css"><link rel="manifest" href="https://madcampos.dev/manifest.webmanifest"></head><body><main><div id="post-header"><nav id="back-to-blog"><a href="/blog/" title="Back to blog"><img src="https://madcampos.dev/icons/favicon.svg" alt="" role="presentation"></a></nav><header><h1>Hello, World!</h1><aside>Published: 2023-05-05</aside></header></div><article id="post-contents"><h1 id="undefinedhello-world">Hello, World!</h1><p>This is how I built this blog, or at least the first iteration of it. So please ride along on this journey of sweet success and sorrowful cryptic error messages.<br>But first let me vent out on my frustrations on modern front-end tooling…</p><h2 id="undefinedrant">#rant</h2><p>I know that vite is amazing and helps in getting a nice and optimized project all the way and having a “no build” development environment is really refreshing and is lovely to work on but I still hate that I’m required to have a build step when generating my files that is for sure a good idea for big projects full of small files and libraries but I’d still like to have the option to opt out of bundling just to have a website that is readable by people and a good place to learn even though it is not as optimal so to be honest I hate to be locked up and have to get out of my way to deal with rollup shenanigans instead of just compiling typescript and be done with it.</p><p>Okay, #rant over, back to the post.</p><h2 id="undefinedthe-why">The why</h2><p>I was talking to a friend about building in the open and decided it would be a good idea to show my skills and thought process. But first I had to decide how to get the content out and where to put it.<br>One idea was to use a hosting service like <a href="https://dev.to/">dev.to</a> or <a href="https://wordpress.org/">WordPress</a> and hook my website to it, but I already have a static site and like to keep things as simple for people accessing it as it can be.</p><p>So, that meant:</p><ol><li>Use the existing infrastructure</li><li>No front-end frameworks (to keep things simple, it has static data only after all)</li><li>Has to integrate well with vite</li><li>I can build it myself if no tools already exist</li></ol><h2 id="undefinedthe-how">The how</h2><p>My investigation began, as usual, with typing “vite blog plugin” on Bing and Google and seeing what that lead me.<br>Unfortunately there were no existing plugins for that. The only option was <a href="https://vitepress.dev/">VitePress</a>, it is a good one but when I tried it was doing too much magic and altering the existing project a lot, so not a “plugin” and more of a “full featured system built <em>on top of</em> vite”.</p><p>That meant I was about to build a plugin or at least write <em>some</em> code myself.</p><p>The investigation followed with some MPA (Multi-page application) plugins for vite. As it was born from the Vue community it’s main porpouse is to build SPAs (Single-page applications) and it’s not the best at building MPAs, but it can be done. The one that cought my attention was <a href="https://github.com/emosheeep/vite-plugin-virtual-mpa/"><code>vite-plugin-virtual-mpa</code></a>. I configured it, wrote a lot of code and then went to test…</p><p>BOOM! Cryptic errors showed up.</p><h2 id="undefinedthe-errors">The errors</h2><p>The error was:</p><pre><code>RollupError: The &quot;fileName&quot; or &quot;name&quot; properties of emitted files must be strings that are neither absolute nor relative paths, received &lt;PATH_TO_FILE&gt;
</code></pre><p>I tried to investigate what was causing it, and to keep a 4 hours of frustration story short, vite uses rollup internally and to build a MPA we have to pass in the <code>input</code> configuration to it so it can find the files and build them. The plugin was generating the files on the dev server but when it came time to build, rollup was not able to find them because they were never created <em>on disk</em>, they were only <em>virtual</em>.</p><h2 id="undefinedthe-failed-atempt">The (failed) atempt</h2><p>I then dug into the source code for <code>vite-plugin-virtual-mpa</code> and tried to create the minimal steps to reproduce the bug.</p><p>The trial and error approach didn’t help as the problem was too intrenched in the plugin’s code and I was not able to find a way to fix it. But after taking a step back it clicked to me: <em>what if I created the files and the input configuration “by hand” and injected it on the <code>src</code> folder then let vite deal with the build part?</em></p><h2 id="undefinedthe-solution">The solution</h2><p>This time I tried the minimal approach first to find bugs and was able to build a working version in a couple of hours. Much of the logic was reused from the plugin fix attempt, I just had to literally write the files on disc and find a way to structure the logic.</p><p>So, the “plugin” does the following steps:</p><ol><li>Walk the <code>blog</code> folder and find all the <code>.md</code> files</li><li>Extract the metadata from the files<br>a. The folder name is the date (e.g. <code>blog/2023-05-05/hello-world.md</code> is from May 5th, 2023)<br>b. The file name is the slug (e.g. <code>blog/2023-05-05/hello-world.md</code> is <code>hello-world</code>)<br>c. The first header on the file is the title (e.g. <code># Hello, World!</code> is the title)<br>d. The first html comment is the metadata with some fields like <code>description</code> and <code>tags</code> (e.g. <code>&lt;!-- description: Summary of the experience and hurdles of coding this blog. --&gt;</code>)</li><li>Create a file structure on the <code>src</code> folder with templates for each page and the extracted metadata</li><li>Export a list of files to be injected by vite and rollup</li><li>Let vite do it’s ✨ magic ✨</li><li>Profit</li></ol><h2 id="undefinedthe-result">The result</h2><p>The result is this blog that you, dear reader, is reading right now. It is not perfect, but it is a good MVP to be up and running and improve as I go.</p><p>The code can be viewed on github on the <a href="https://github.com/madcampos/madcampos.github.io/blob/main/build/blog.ts"><code>blog.ts</code></a>.</p><h2 id="undefinednext-steps">Next steps</h2><p>There sre still some point to improve, the next ones I intend to tackle are the styling of the blog that is pretty barebones and pagination.<br>But those are for future posts.</p></article></main></body></html>